## 용어 사전 만들기

> 용어 사전은 프로젝트(또는 서비스)에 참여하는 도메인 전문가, 개발자, 기획자, 디자이너 등 다양한 직군 간의 의사소통을 명확하게 하기 위한 도구입니다. 이 사전은 하위 도메인과 바운디드 컨텍스트를 기준으로 도메인 내 개념을 일관되게 설명합니다.

하위 도메인은 자연스럽게 나뉘는 주제 영역입니다.

* 비즈니스 전체 흐름 속에서 각 영역이 무엇을 책임지는지에 따라 구분됩니다.

바운디드 컨텍스트는 시스템이 책임지는 논리적 경계입니다. (=개발자가 인위적으로 경계를 나누는 것)

* 개발자가 일하기 편하게 쪼갠 구현 단위이며, 내부에는 의미 있는 도메인 객체들이 존재하고 상호작용합니다.
* 같은 단어라도 컨텍스트마다 의미가 다를 수 있으므로, 언어와 의미가 일관되게 작동하는 유효 범위라고도 볼 수 있습니다.

즉, 하위 도메인은 '무엇'을 다루는지, 바운디드 컨텍스트는 '어디까지 책임질 것인지'를 결정한다고 이해하시면 됩니다.

### 하위 도메인

* User: 사용자 및 관리자 (아이디, 비밀번호, 권한)
* Coupon: 쿠폰 생성, 발급, 사용 등 전체 로직

### 바운디드 컨텍스트

| 바운디드 컨텍스트         | 설명                                   |
|-------------------|--------------------------------------|
| User              | 로그인, 사용자 인증 처리                       |
| Coupon            | 쿠폰 생성, 수량·유효기간 관리                    |
| IssuedCoupon      | 사용자에게 발급된 쿠폰 관리 (발급, 중복 방지, 사용 처리 등) |
| UserCouponHistory | 사용자가 보유하거나 사용한 쿠폰 이력 조회              |

```markdown
[Coupon] ──▶ 쿠폰 정의
     │ defines
     ▼
[IssuedCoupon] ──▶ 발급 및 사용 처리
     │
     ▼
[UserCouponHistory] ◀─ 사용자별 이력 조회
```

---

### User (사용자)

> 사용자 정보를 등록, 인증, 조회하고 권한을 관리하는 도메인입니다.

| 한글명    | 영문명      | 설명                            |
| ------ | -------- | ----------------------------- |
| 사용자 ID | id       | 내부 시스템에서 사용하는 고유 식별자 (UUID 등) |
| 아이디    | Username | 로그인 시 사용하는 식별자                |
| 비밀번호   | Password | 비밀번호 (암호화 저장)                 |
| 권한     | UserRole | ADMIN 또는 USER 값. 관리자/사용자 구분용  |

### Coupon (쿠폰 정의)

> 쿠폰 발급의 템플릿을 정의하고, 쿠폰의 속성 및 정책을 관리하는 도메인입니다.

| 한글명    | 영문명           | 설명                                          |
| ------ | ------------- | ------------------------------------------- |
| 쿠폰 ID  | couponId      | 쿠폰 정의의 고유 식별자 (UUID)                        |
| 쿠폰 이름  | name          | 쿠폰 제목 또는 설명                                 |
| 쿠폰 타입  | couponType    | CHICKEN, PIZZA, BURGER 등                    |
| 발급 수량  | totalQuantity | 발급 가능한 총 수량                                 |
| 유효 시작일 | validFrom     | 사용 가능 시작일                                   |
| 유효 종료일 | validUntil    | 만료일                                         |
| 쿠폰 상태  | status        | ACTIVE(사용 가능), EXPIRED(만료됨), DISABLED(비활성화) |

### IssuedCoupon (발급된 쿠폰)

> 사용자에게 발급된 쿠폰을 관리하며, 발급, 중복 방지, 사용 처리 등의 비즈니스 로직을 포함하는 도메인입니다.

| 한글명      | 영문명             | 설명                      |
| -------- | --------------- | ----------------------- |
| 발급 쿠폰 ID | issuedCouponId  | 사용자에게 발급된 쿠폰의 고유 식별자    |
| 사용자 ID   | userId          | 해당 쿠폰을 발급받은 사용자         |
| 쿠폰 ID    | couponId        | 어떤 쿠폰이 발급되었는지 참조        |
| 발급일      | issuedAt        | 쿠폰이 발급된 시점              |
| 사용 여부    | used            | 쿠폰이 사용되었는지 여부 (boolean) |
| 사용일      | usedAt          | 쿠폰 사용 시점                |
| 중복 방지 키  | userId+couponId | 복합 유니크 키로 중복 발급 방지      |

### UserCouponHistory (사용자 쿠폰 이력 조회, 조회 전용 View)

> 사용자 기준으로 발급된 쿠폰의 보유 여부, 사용 이력, 만료 여부 등을 조회하는 도메인입니다. 조회 성능 중심의 Projection View 또는 Read Model로 구성됩니다.

| 한글명      | 영문명            | 설명                                            |
| -------- | -------------- | --------------------------------------------- |
| 사용자 ID   | userId         | 쿠폰 소유자                                        |
| 발급 쿠폰 ID | issuedCouponId | 사용자가 발급받은 개별 쿠폰 ID (Projection View에서 필드로 표현) |
| 사용 여부    | used           | 쿠폰 사용 여부 (필터 조건 가능)                           |
| 쿠폰 타입    | couponType     | 발급받은 쿠폰의 종류                                   |
| 발급일      | issuedAt       | 발급 시점                                         |
| 사용일      | usedAt         | 사용한 경우 사용 시각                                  |
| 만료일      | validUntil     | 만료된 쿠폰 필터링용 정보                                |
| 조회 기준 상태 | statusFilter   | ALL, USED, UNUSED, EXPIRED 등 조회 조건            |

---

## 모델링 하기

> 모델링은 하위 도메인과 바운디드 컨텍스트를 기준으로 도메인 객체를 설계하고, 해당 객체의 속성(상태), 행위(기능), 정책(제약사항)을 구분하여 구조화하는 작업입니다.
>
> 이 과정은 협업 부서와 개발자가 도메인 개념을 명확히 이해하고 일관되게 구현할 수 있도록 돕는 설계/문서화 작업입니다.
>
> 본 프로젝트에서는 JPA를 사용하므로, 도메인 객체를 JPA 엔티티로 정의하고, 이를 기준으로 모델링을 진행합니다.

---

### User (사용자)

속성(상태)

* 사용자는 회원가입할 때 등록할 아이디와 비밀번호가 있다.

행위(기능)

* 사용자는 아이디와 비밀번호를 가지고 회원가입할 수 있다.
* 아이디와 비밀번호를 가지고 로그인을 할 수 있다.

정책(제약사항)

* 회원가입
  * 아이디 또는 비밀번호는 1자 이상이어야 한다.
  * 중복된 아이디는 존재할 수 없다.
  * 비밀번호는 암호화하여 저장해야 한다.

* 로그인
  * 로그인 시 아이디와 비밀번호가 입력해야 한다.

### Coupon (쿠폰 정의)

속성(상태)

* 쿠폰에는 쿠폰 이름, 쿠폰 타입, 쿠폰 상태, 발급 수량, 유효 시작일, 유효 종료일가 있다.
  * 쿠폰 타입에는 치킨(`CHICKEN`), 햄버거(`HAMBURGER`), 피자(`PIZZA`)가 있다.
  * 쿠폰 상태는 `ACTIVE`(사용 가능), `EXPIRED`(사용됨), `DISABLED`(사용 불가)가 있다.

행위(기능)

* 관리자는 쿠폰을 발급(생성)할 수 있다.
* 쿠폰은 발급 시 발급 수량을 감소시킬 수 있다.
* 쿠폰의 유효기간에 따라 상태를 만료 처리할 수 있다.

정책(제약사항)

* 쿠폰 발급(생성)
  * 발급 가능 수량과 유효기간이 설정되어야 한다.
  * 쿠폰 발급 수량은 1 이상이야 한다.
  * 유효 종료일이 지나면 쿠폰 상태는 `EXPIRED` 로 변경될 수 있다.

### IssuedCoupon (발급된 쿠폰)

속성(상태)

* 사용자 ID, 쿠폰 ID, 발급일, 사용 여부, 사용일

행위(기능)

* 쿠폰 발급 요청을 처리할 수 있다.
* 발급된 쿠폰을 사용 처리할 수 있다.

정책(제약사항)

* 중복 발급 방지
  * 동일 사용자에게 동일 쿠폰은 1회만 발급 가능 → `userId + couponId` 유니크
* 쿠폰 사용
  * 사용된 쿠폰은 재사용이 불가능하다.
  * 유효 기간이 지난 쿠폰은 사용할 수 없다.
