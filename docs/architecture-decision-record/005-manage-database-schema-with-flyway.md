# ADR 005: Flyway를 이용한 데이터베이스 스키마 버전 관리

DATE: 2025.09.02 (PR [#46](https://github.com/devFancy/springboot-coupon-system/pull/46) 참고)

## 상태 (Status)

Accepted

## 맥락 (Context)

프로젝트 초기 단계에서 JPA의 `ddl-auto: update` 옵션에 의존할 경우, 개발 환경 간의 스키마 불일치 문제가 발생할 수 있으며 운영 환경에서의 변경 이력 추적이 불가능하다. 
안전한 배포와 협업을 위해 데이터베이스 형상을 코드로서 관리할 필요가 있다.

## 결정 (Decision)

데이터베이스 마이그레이션 도구인 Flyway를 도입한다.
- 모든 스키마 변경 사항은 SQL 스크립트 파일(`V1__init.sql` 등)로 작성하여 버전 관리 시스템(Git)에 포함한다.
- 애플리케이션 기동 시점에 자동으로 마이그레이션을 수행하여 모든 환경의 DB 스키마를 동기화한다.

## 결과 (Consequences)

긍정적 효과 (Pros)
- 로컬, 테스트, 운영 환경의 DB 형상을 완벽히 일치시킬 수 있으며 스키마 변경 이력이 투명하게 관리된다.

부정적 효과 및 트레이드오프 (Cons)
- 이미 적용된 마이그레이션 파일은 수정할 수 없으므로(Checksum 오류), 실수를 바로잡기 위해서는 추가적인 마이그레이션 파일을 생성해야 한다.
